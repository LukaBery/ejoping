<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="ko"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>BookController.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">bookstore</a> &gt; <a href="index.source.html" class="el_package">com.nhnacademy.bookstore.bookset.book.controller</a> &gt; <span class="el_source">BookController.java</span></div><h1>BookController.java</h1><pre class="source lang-java linenums">package com.nhnacademy.bookstore.bookset.book.controller;

import com.nhnacademy.bookstore.bookset.book.dto.request.BookCreateRequestDto;
import com.nhnacademy.bookstore.bookset.book.dto.request.BookUpdateRequestDto;
import com.nhnacademy.bookstore.bookset.book.dto.response.*;
import com.nhnacademy.bookstore.bookset.book.service.BookService;
import com.nhnacademy.bookstore.bookset.publisher.exception.PublisherNotFoundException;
import com.nhnacademy.bookstore.common.error.exception.bookset.category.CategoryNotFoundException;
import com.nhnacademy.bookstore.common.error.exception.bookset.contributor.ContributorNotFoundException;
import io.swagger.v3.oas.annotations.Operation;
import io.swagger.v3.oas.annotations.responses.ApiResponse;
import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.data.domain.Page;
import org.springframework.data.domain.Pageable;
import org.springframework.data.domain.Sort;
import org.springframework.data.web.PageableDefault;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

import java.util.List;

/**
 * 도서 Controller
 *
 * @author : 이유현
 * @date : 2024.10.29
 */

<span class="fc" id="L31">@Slf4j</span>
@RestController
@RequestMapping(&quot;/api/v1/bookstore&quot;)
@RequiredArgsConstructor
public class BookController {

    private final BookService bookService;

    /**
     * 도서를 단독으로 등록하는 controller
     *
     * @return 등록한 도서와 상태 코드를 담은 응답
     */
    @Operation(summary = &quot;도서 단독 등록&quot;, description = &quot;새로운 도서를 등록합니다.&quot;)
    @ApiResponse(responseCode = &quot;201&quot;, description = &quot;도서 생성 성공&quot;)
    @ApiResponse(responseCode = &quot;404&quot;, description = &quot;리소스를 찾을 수 없음&quot;)
    @ApiResponse(responseCode = &quot;400&quot;, description = &quot;잘못된 요청 데이터&quot;)
    @PostMapping(value = &quot;/admin/books/register&quot;)
    public ResponseEntity&lt;BookCreateResponseDto&gt; createBook(@RequestBody BookCreateRequestDto bookCreateRequestDto) {
        try {
<span class="fc" id="L51">            BookCreateResponseDto book = bookService.createBook(bookCreateRequestDto);</span>
<span class="fc" id="L52">            return ResponseEntity.status(HttpStatus.CREATED).body(book);</span>
<span class="fc" id="L53">        } catch (Exception ex) {</span>
<span class="fc" id="L54">            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(null);</span>
        }
    }

    /**
     * 알라딘 API 이용해 도서 등록하는 controller
     *
     * @return 등록한 도서와 상태 코드를 담은 응답
     */
    @Operation(summary = &quot;알라딘 API 활용 도서 등록&quot;, description = &quot;알라딘 API를 활용해 새로운 도서를 등록합니다.&quot;)
    @ApiResponse(responseCode = &quot;201&quot;, description = &quot;도서 생성 성공&quot;)
    @ApiResponse(responseCode = &quot;404&quot;, description = &quot;리소스를 찾을 수 없음&quot;)
    @ApiResponse(responseCode = &quot;400&quot;, description = &quot;잘못된 요청 데이터&quot;)
    @PostMapping(&quot;/admin/books/register/aladin&quot;)
    public ResponseEntity&lt;List&lt;BookCreateAPIResponseDto&gt;&gt; createBooks(String query) {
        try {
<span class="nc" id="L70">            List&lt;BookCreateAPIResponseDto&gt; books = bookService.createBooks(query);</span>
<span class="nc" id="L71">            return ResponseEntity.status(HttpStatus.CREATED).body(books);</span>
<span class="nc" id="L72">        } catch (PublisherNotFoundException | ContributorNotFoundException | CategoryNotFoundException ex) {</span>
<span class="nc" id="L73">            return ResponseEntity.status(HttpStatus.NOT_FOUND).body(null);</span>
<span class="nc" id="L74">        } catch (Exception ex) {</span>
<span class="nc" id="L75">            ex.printStackTrace();</span>
<span class="nc" id="L76">            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(null);</span>
        }
    }

    /**
     * 전체 도서를 조회하는 controller
     *
     * @return 전체 도서와 상태 코드를 담은 응답
     */
    @Operation(summary = &quot;전체 도서 조회&quot;, description = &quot;등록된 모든 도서를 조회합니다.&quot;)
    @GetMapping(&quot;/books/get&quot;)// 임시로 설정해둔거
    public ResponseEntity&lt;Page&lt;BookSimpleResponseDto&gt;&gt; getAllBooks(
            @PageableDefault(size = 10, sort = &quot;title&quot;, direction = Sort.Direction.ASC) Pageable pageable) {
<span class="fc" id="L89">        Page&lt;BookSimpleResponseDto&gt; books = bookService.getAllBooks(pageable);</span>
<span class="fc" id="L90">        return ResponseEntity.status(HttpStatus.OK).body(books);</span>
    }

    /**
     * 카테고리별 도서를 조회하는 controller
     *
     * @param categoryId 조회하려는 카테고리 id
     * @return 카테고리로 조회한 도서와 상태 코드를 담은 응답
     */
    @Operation(summary = &quot;카테고리로 도서 조회&quot;, description = &quot;카테고리별 도서를 조회합니다.&quot;)
    @GetMapping(&quot;/books/get/category/{category-id}&quot;)// 임시로 설정해둔거
    public ResponseEntity&lt;Page&lt;BookSimpleResponseDto&gt;&gt; getBooksByCategoryId(@PathVariable(&quot;category-id&quot;) Long categoryId,
                                                                            @PageableDefault(size = 10, sort = &quot;title&quot;, direction = Sort.Direction.ASC) Pageable pageable) {
<span class="fc" id="L103">        log.info(&quot;카테고리별 도서를 조회하는 컨트롤러 !!&quot;);</span>
<span class="fc" id="L104">        Page&lt;BookSimpleResponseDto&gt; books = bookService.getBooksByCategoryId(pageable, categoryId);</span>
<span class="fc" id="L105">        return ResponseEntity.status(HttpStatus.OK).body(books);</span>
    }

    /**
     * 기여자별 도서를 조회하는 controller
     *
     * @param contributorId 조회하려는 기여자 id
     * @return 기여자로 조회한 상태 코드를 담은 응답
     */
    @Operation(summary = &quot;기여자로 도서 조회&quot;, description = &quot;기여자별 도서를 조회합니다.&quot;)
    @GetMapping(&quot;/books/get/contributor/{contributor-id}&quot;)// 임시로 설정해둔거
    public ResponseEntity&lt;Page&lt;BookSimpleResponseDto&gt;&gt; getBooksByContributorId(@PathVariable(&quot;contributor-id&quot;) Long contributorId,
                                                                               @PageableDefault(size = 10, sort = &quot;title&quot;, direction = Sort.Direction.ASC) Pageable pageable) {
<span class="fc" id="L118">        Page&lt;BookSimpleResponseDto&gt; books = bookService.getBooksByContributorId(pageable, contributorId);</span>
<span class="fc" id="L119">        return ResponseEntity.status(HttpStatus.OK).body(books);</span>
    }

    /**
     * 특정 도서의 상세 정보를 조회하는 controller
     *
     * @param bookId 조회하려는 도서 id
     * @return 특정 도서와 상태 코드를 담은 응답
     */
    @Operation(summary = &quot;특정 도서 상세 조회&quot;, description = &quot;특정 도서의 상세 정보를 조회합니다.&quot;)
    @GetMapping(&quot;/books/get/book/{book-id}&quot;)
    public ResponseEntity&lt;BookResponseDto&gt; getBookByBookId(@PathVariable(&quot;book-id&quot;) Long bookId) {
<span class="fc" id="L131">        BookResponseDto book = bookService.getBookById(bookId);</span>
<span class="fc" id="L132">        return ResponseEntity.status(HttpStatus.OK).body(book);</span>
    }

    /**
     * 특정 도서 수정 controller
     *
     * @param bookId 조회하려는 도서 id
     * @return 특정 도서와 상태 코드를 담은 응답
     */
    @Operation(summary = &quot;특정 도서 수정 정보 조회&quot;, description = &quot;특정 도서 정보를 수정을 위해 기존 정보를 조회합니다.&quot;)
    @GetMapping(&quot;admin/books/{bookId}&quot;)
    public ResponseEntity&lt;BookUpdateResponseDto&gt; getUpdateBookByBookId(@PathVariable(&quot;bookId&quot;) Long bookId) {
<span class="fc" id="L144">        BookUpdateResponseDto book = bookService.getUpdateBookByBookId(bookId);</span>
<span class="fc" id="L145">        return ResponseEntity.status(HttpStatus.OK).body(book);</span>
    }

    /**
     * 특정 도서 수정 controller
     *
     * @param bookId 조회하려는 도서 id
     * @return 특정 도서와 상태 코드를 담은 응답
     */
    @Operation(summary = &quot;특정 도서 수정&quot;, description = &quot;특정 도서 정보를 수정합니다.&quot;)
    @PutMapping(&quot;admin/books/{bookId}&quot;)
    public ResponseEntity&lt;BookUpdateResultResponseDto&gt; updateBook(@PathVariable(&quot;bookId&quot;) Long bookId, @RequestBody BookUpdateRequestDto bookUpdateRequestDto) {
<span class="fc" id="L157">        BookUpdateResultResponseDto book = bookService.updateBook(bookId, bookUpdateRequestDto);</span>
<span class="fc" id="L158">        return ResponseEntity.status(HttpStatus.OK).body(book);</span>
    }

    /**
     * 특정 도서를 삭제하는 controller
     *
     * @param bookId 삭제하려는 도서 id
     * @return 삭제된 도서 ID와 상태 코드를 담은 응답
     */
    @Operation(summary = &quot;특정 도서 삭제&quot;, description = &quot;특정 도서를 삭제합니다.&quot;)
    @PutMapping(&quot;/admin/books/{book-id}/deactivate&quot;)
    public ResponseEntity&lt;Long&gt; deactivateBook(@PathVariable(&quot;book-id&quot;) Long bookId) {
<span class="fc" id="L170">        bookService.deactivateBook(bookId);</span>
<span class="fc" id="L171">        return ResponseEntity.status(HttpStatus.OK).body(bookId);</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.9.202303310957</span></div></body></html>